(()=>{var e={};e.id=898,e.ids=[898],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},91978:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>o});var s=r(50482),a=r(69108),l=r(62563),n=r.n(l),i=r(68300),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);r.d(t,d);let o=["",{children:["dashboard",{children:["printer",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,79306)),"/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/printer/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,96339)),"/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,82917)),"/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/printer/page.tsx"],x="/dashboard/printer/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/printer/page",pathname:"/dashboard/printer",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},11945:(e,t,r)=>{Promise.resolve().then(r.bind(r,38077))},38077:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(95344),a=r(3729),l=r(27984),n=r(63024),i=r(69599),d=r(55794),o=r(80508),c=r(40626),x=r(71206),m=r(20016),p=r(96885),g=r(8428);function u(){let e=(0,g.useRouter)(),[t,r]=(0,a.useState)([]),[u,h]=(0,a.useState)(new Map),[b,j]=(0,a.useState)(!0),[v,f]=(0,a.useState)(null),[y,N]=(0,a.useState)("all");(0,a.useEffect)(()=>{_()},[]);let _=async()=>{try{j(!0);let{data:e,error:t}=await l.O.from("printer_foiling_orders").select("*").order("event_date",{ascending:!0});if(t)throw console.error("Error fetching orders:",t),t;if(e){r(e);let t=new Map;for(let r of e){let{data:e}=await l.O.from("booking_wrapping_images").select("id, file_name, image_url, uploaded_at").eq("booking_id",r.id).order("uploaded_at",{ascending:!1});e&&t.set(r.id,e)}h(t)}}catch(e){console.error("Error:",e)}finally{j(!1)}};return b?s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.jsx("div",{className:"p-8 bg-gray-50 min-h-screen",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>e.back(),className:"p-2 hover:bg-gray-200 rounded-lg transition",children:s.jsx(n.Z,{size:24,className:"text-gray-600"})}),(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"\uD83D\uDDA8️ Tryckeri - Foliering"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Bekr\xe4ftade ordrar f\xf6r foliering"})]})]}),s.jsx("button",{onClick:_,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold transition",children:"\uD83D\uDD04 Uppdatera"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[s.jsx("p",{className:"text-sm text-gray-600 font-semibold",children:"Aktiva Ordrar"}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:t.length})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[s.jsx("p",{className:"text-sm text-gray-600 font-semibold",children:"Bilder Uppladdade"}),s.jsx("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:Array.from(u.values()).reduce((e,t)=>e+t.length,0)})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[s.jsx("p",{className:"text-sm text-gray-600 font-semibold",children:"Denna Vecka"}),s.jsx("p",{className:"text-3xl font-bold text-purple-600 mt-2",children:t.filter(e=>{let t=new Date(e.event_date),r=new Date,s=new Date(r.getTime()+6048e5);return t>=r&&t<=s}).length})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[s.jsx("p",{className:"text-sm text-gray-600 font-semibold",children:"V\xe4ntande Bilder"}),s.jsx("p",{className:"text-3xl font-bold text-orange-600 mt-2",children:t.filter(e=>0===(e.image_count||0)).length})]})]}),s.jsx("div",{className:"space-y-4",children:0===t.length?(0,s.jsxs)("div",{className:"bg-white rounded-lg p-8 text-center border border-gray-200",children:[s.jsx(i.Z,{size:48,className:"mx-auto text-gray-300 mb-4"}),s.jsx("p",{className:"text-gray-500 font-semibold",children:"Inga folierings-ordrar"})]}):t.map(e=>{let t=u.get(e.id)||[];return(0,s.jsxs)("div",{className:"bg-white rounded-lg border-2 border-gray-200 p-4 hover:border-blue-300 transition",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-start mb-4",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"font-bold text-lg text-gray-900",children:e.booking_number}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.customer_name})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(d.Z,{size:16,className:"text-blue-600"}),s.jsx("span",{children:new Date(e.event_date).toLocaleDateString("sv-SE")})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(o.Z,{size:16,className:"text-blue-600"}),s.jsx("span",{children:e.location})]})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(c.Z,{size:16,className:"text-green-600"}),s.jsx("a",{href:`tel:${e.customer_phone}`,className:"text-blue-600 hover:underline",children:e.customer_phone})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(x.Z,{size:16,className:"text-green-600"}),s.jsx("a",{href:`mailto:${e.customer_email}`,className:"text-blue-600 hover:underline text-xs",children:e.customer_email})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 bg-blue-50 px-3 py-2 rounded-lg border border-blue-200",children:[s.jsx(m.Z,{size:16,className:"text-blue-600"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-blue-600",children:[t.length," bilder"]})]}),0===t.length&&s.jsx("p",{className:"text-xs text-orange-600 mt-2 font-semibold",children:"⚠️ V\xe4ntande bilder"})]}),s.jsx("div",{children:s.jsx("button",{onClick:()=>f(v===e.id?null:e.id),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold transition text-sm",children:v===e.id?"▼ G\xf6m":"▶ Visa Bilder"})})]}),v===e.id&&(0,s.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,s.jsxs)("div",{className:"mb-4",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:"\uD83D\uDCE6 Produkter f\xf6r Foliering:"}),s.jsx("div",{className:"bg-gray-50 p-3 rounded-lg",children:(()=>{let t=[];try{"string"==typeof e.products_requested?t=JSON.parse(e.products_requested):Array.isArray(e.products_requested)&&(t=e.products_requested)}catch(e){console.error("Error parsing products:",e)}return t.filter(e=>e.wrapping_requested).map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700 py-1",children:[s.jsx("span",{className:"text-blue-600",children:"✓"}),(0,s.jsxs)("span",{children:[s.jsx("strong",{children:e.name})," ",e.quantity&&`(x${e.quantity})`]})]},t))})()})]}),t.length>0?(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:"\uD83D\uDCF8 Uppladdade Bilder:"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:t.map(e=>(0,s.jsxs)("a",{href:e.image_url,target:"_blank",rel:"noopener noreferrer",className:"relative group overflow-hidden rounded-lg border-2 border-gray-200 hover:border-blue-500 transition",children:[s.jsx("img",{src:e.image_url,alt:e.file_name,className:"w-full h-32 object-cover group-hover:scale-110 transition"}),s.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition rounded-lg",children:s.jsx(p.Z,{size:24,className:"text-white"})}),(0,s.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2",children:[s.jsx("p",{className:"text-xs text-white font-semibold truncate",children:e.file_name}),s.jsx("p",{className:"text-xs text-gray-300",children:new Date(e.uploaded_at).toLocaleDateString("sv-SE")})]})]},e.id))})]}):s.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 text-center",children:s.jsx("p",{className:"text-sm text-orange-700 font-semibold",children:"⏳ V\xe4ntar p\xe5 att kunden laddar upp folierings-bilder..."})})]})]},e.id)})})]})})}},96885:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},71206:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},40626:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},79306:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>l,__esModule:()=>a,default:()=>n});let s=(0,r(86843).createProxy)(String.raw`/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/printer/page.tsx`),{__esModule:a,$$typeof:l}=s,n=s.default}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,356,880,934,142],()=>r(91978));module.exports=s})();