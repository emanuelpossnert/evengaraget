(()=>{var e={};e.id=608,e.ids=[608],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},69662:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>g,tree:()=>d});var a=s(50482),r=s(69108),n=s(62563),l=s.n(n),i=s(68300),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["dashboard",{children:["activity-log",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6299)),"/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/activity-log/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,96339)),"/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,82917)),"/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/activity-log/page.tsx"],m="/dashboard/activity-log/page",u={require:s,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/activity-log/page",pathname:"/dashboard/activity-log",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},22679:(e,t,s)=>{Promise.resolve().then(s.bind(s,20970))},92611:(e,t,s)=>{Promise.resolve().then(s.bind(s,77501))},16133:()=>{},37298:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2583,23)),Promise.resolve().then(s.t.bind(s,26840,23)),Promise.resolve().then(s.t.bind(s,38771,23)),Promise.resolve().then(s.t.bind(s,13225,23)),Promise.resolve().then(s.t.bind(s,9295,23)),Promise.resolve().then(s.t.bind(s,43982,23))},20970:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(95344),r=s(3729),n=s(27984),l=s(96885);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(69224).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function o(){let[e,t]=(0,r.useState)([]),[s,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)("all"),[m,u]=(0,r.useState)("all");(0,r.useEffect)(()=>{g()},[]);let g=async()=>{try{o(!0);let{data:e}=await n.O.from("bookings").select("*").order("updated_at",{ascending:!1}).limit(50);if(e){let s=e.map((e,t)=>({id:`${t}`,action:"updated",entity_type:"booking",entity_id:e.id,entity_name:e.booking_number,user_email:"system@eventgaraget.se",details:`Status \xe4ndrad till ${e.status}`,timestamp:e.updated_at}));t(s)}}catch(e){console.error("Error fetching activity log:",e)}finally{o(!1)}},x=e.filter(e=>("all"===d||e.action===d)&&("all"===m||e.entity_type===m)),h=e=>({created:"Skapad",updated:"Uppdaterad",deleted:"Borttagen",signed:"Signerad",sent:"Skickad"})[e]||e,p=e=>{switch(e){case"created":return"bg-green-100 text-green-700";case"updated":return"bg-blue-100 text-blue-700";case"deleted":return"bg-red-100 text-red-700";case"signed":return"bg-purple-100 text-purple-700";case"sent":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}},b=e=>({booking:"Bokning",quotation:"Offert",invoice:"Faktura",customer:"Kund",product:"Produkt"})[e]||e;return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Aktivitetslogg"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"\xd6versikt \xf6ver alla \xe4ndringar i systemet"})]}),(0,a.jsxs)("button",{className:"flex items-center gap-2 bg-blue-50 text-blue-600 px-6 py-3 rounded-lg hover:bg-blue-100 transition-colors font-semibold",children:[a.jsx(l.Z,{size:18}),"Exportera"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 border border-gray-200 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(i,{size:20}),a.jsx("h2",{className:"font-bold text-gray-900",children:"Filter"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\xc5tg\xe4rd"}),(0,a.jsxs)("select",{value:d,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500",children:[a.jsx("option",{value:"all",children:"Alla"}),a.jsx("option",{value:"created",children:"Skapad"}),a.jsx("option",{value:"updated",children:"Uppdaterad"}),a.jsx("option",{value:"deleted",children:"Borttagen"}),a.jsx("option",{value:"signed",children:"Signerad"}),a.jsx("option",{value:"sent",children:"Skickad"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Typ"}),(0,a.jsxs)("select",{value:m,onChange:e=>u(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500",children:[a.jsx("option",{value:"all",children:"Alla"}),a.jsx("option",{value:"booking",children:"Bokning"}),a.jsx("option",{value:"quotation",children:"Offert"}),a.jsx("option",{value:"invoice",children:"Faktura"}),a.jsx("option",{value:"customer",children:"Kund"}),a.jsx("option",{value:"product",children:"Produkt"})]})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Resultat"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[x.length," aktiviteter hittades"]})]})]})]}),a.jsx("div",{className:"space-y-3",children:s?a.jsx("div",{className:"text-center py-12 text-gray-500",children:"Laddar aktivitetslogg..."}):0===x.length?a.jsx("div",{className:"text-center py-12 text-gray-500",children:"Ingen aktivitet hittad"}):x.map((e,t)=>a.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200 hover:border-gray-300 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center pt-1",children:[a.jsx("div",{className:"w-4 h-4 rounded-full bg-red-600"}),t!==x.length-1&&a.jsx("div",{className:"w-1 h-12 bg-gray-200 my-2"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-xs font-medium ${p(e.action)}`,children:h(e.action)}),a.jsx("span",{className:"inline-flex px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700",children:b(e.entity_type)})]}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.entity_name}),e.details&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.details}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-xs text-gray-500",children:[(0,a.jsxs)("span",{children:["\uD83D\uDC64 ",e.user_email]}),(0,a.jsxs)("span",{children:["\uD83D\uDCC5 ",new Date(e.timestamp).toLocaleDateString("sv-SE")," ",new Date(e.timestamp).toLocaleTimeString("sv-SE")]})]})]})]})},e.id))})]})}},77501:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>P});var a=s(95344),r=s(3729),n=s(8428),l=s(27984),i=s(56506),o=s(2273),d=s(89895),c=s(12401),m=s(2246),u=s(55794),g=s(16278),x=s(69599),h=s(91917),p=s(75950),b=s(37121),f=s(50340),v=s(28240),y=s(13746),j=s(48120);function N({user:e,onLogout:t}){let s=(0,n.usePathname)(),[N,k]=(0,r.useState)({});(0,r.useEffect)(()=>{w()},[]);let w=async()=>{try{let e={},{data:t}=await l.O.from("booking_tasks").select("id").eq("status","pending");e.todo=t?.length||0;let{data:s}=await l.O.from("bookings").select("id").eq("status","pending");e.bookings=s?.length||0;let{data:a}=await l.O.from("printer_foiling_orders").select("id");e.printer=a?.length||0;let{data:r}=await l.O.from("booking_tasks").select("id").neq("status","completed");e.warehouse=r?.length||0,k(e)}catch(e){console.error("Error fetching badge counts:",e)}},_=[{name:"Dashboard",icon:o.Z,href:"/dashboard",roles:["admin","manager"]},{name:"Kunder",icon:d.Z,href:"/dashboard/customers",roles:["admin","manager","support"]},{name:"Bokningar",icon:c.Z,href:"/dashboard/bookings",roles:["admin","manager"]},{name:"Att G\xf6ra",icon:m.Z,href:"/dashboard/todo",roles:["admin","manager"]},{name:"Kalender",icon:u.Z,href:"/dashboard/calendar",roles:["admin","manager","warehouse"]},{name:"Lager",icon:g.Z,href:"/dashboard/warehouse",roles:["warehouse"]},{name:"Lager Admin",icon:g.Z,href:"/dashboard/warehouse-admin",roles:["admin"]},{name:"Tryckeri",icon:x.Z,href:"/dashboard/printer",roles:["admin","printer"]},{name:"Produkter & Prislista",icon:h.Z,href:"/dashboard/products",roles:["admin","manager"]},{name:"FAQ",icon:p.Z,href:"/dashboard/faq",roles:["admin","manager"]},{name:"Till\xe4gg",icon:h.Z,href:"/dashboard/addons",roles:["admin","manager"]},{name:"Aktivitetslogg",icon:b.Z,href:"/dashboard/activity-log",roles:["admin"]},{name:"Analytics",icon:f.Z,href:"/dashboard/analytics",roles:["admin"]},{name:"Anv\xe4ndare",icon:v.Z,href:"/dashboard/users",roles:["admin"]},{name:"Inst\xe4llningar",icon:y.Z,href:"/dashboard/settings",roles:["admin"]}].filter(t=>t.roles.includes(e.role));return(0,a.jsxs)("aside",{className:"fixed left-0 top-0 h-screen w-64 bg-white border-r border-gray-200 flex flex-col",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("img",{src:"/logo.png",alt:"EventGaraget",className:"h-18"})})}),a.jsx("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:_.map(e=>{let t=e.icon,r="/dashboard"===e.href?s===e.href:s.startsWith(e.href),n=0;return"/dashboard/todo"===e.href&&(n=N.todo||0),"/dashboard/bookings"===e.href&&(n=N.bookings||0),"/dashboard/printer"===e.href&&(n=N.printer||0),"/dashboard/warehouse"===e.href&&(n=N.warehouse||0),(0,a.jsxs)(i.default,{href:e.href,className:`flex items-center gap-3 px-4 py-2 rounded-lg transition-colors justify-between ${r?"bg-red-50 text-red-600 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(t,{size:20}),a.jsx("span",{children:e.name})]}),n>0&&a.jsx("span",{className:"bg-red-600 text-white text-xs font-bold px-2 py-1 rounded-full min-w-max",children:n})]},e.href)})}),(0,a.jsxs)("div",{className:"p-4 border-t border-gray-200 space-y-3",children:[(0,a.jsxs)("div",{className:"px-4 py-3 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.full_name}),a.jsx("p",{className:"text-xs text-gray-500",children:e.email}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 capitalize mt-1",children:["Rolle: ",e.role]})]}),(0,a.jsxs)("button",{onClick:t,className:"w-full flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[a.jsx(j.Z,{size:18}),a.jsx("span",{className:"text-sm",children:"Logga ut"})]})]})]})}var k=s(28765),w=s(33037);function _({user:e}){return(0,a.jsxs)("div",{className:"fixed top-0 left-64 right-0 h-16 bg-white border-b border-gray-200 flex items-center justify-between px-8 z-40",children:[a.jsx("div",{className:"flex-1 max-w-md",children:(0,a.jsxs)("div",{className:"relative",children:[a.jsx(k.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),a.jsx("input",{type:"text",placeholder:"S\xf6k kunder, bokningar...",className:"w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-red-500 focus:bg-white"})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-6 ml-8",children:[(0,a.jsxs)("button",{className:"relative p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsx(w.Z,{size:20}),a.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 pl-6 border-l border-gray-200",children:[a.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-sm font-bold text-red-600",children:e.full_name.split(" ").map(e=>e[0]).join("").toUpperCase()})}),a.jsx("span",{className:"text-sm text-gray-700",children:e.full_name})]})]})]})}function P({children:e}){let t=(0,n.useRouter)(),[s,i]=(0,r.useState)(null),[o,d]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{try{let{data:{session:e}}=await l.O.auth.getSession();if(!e){t.push("/");return}let{data:s}=await l.O.from("user_profiles").select("*").eq("id",e.user.id).single();s&&i(s)}catch(e){console.error("Auth check error:",e),t.push("/")}finally{d(!1)}})()},[t]);let c=async()=>{await l.O.auth.signOut(),t.push("/")};return o?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-lg gradient-primary animate-pulse mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Laddar..."})]})}):s?(0,a.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[a.jsx(N,{user:s,onLogout:c}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col ml-64",children:[a.jsx(_,{user:s}),a.jsx("main",{className:"flex-1 overflow-auto pt-20 px-8 pb-8",children:e})]})]}):null}},27984:(e,t,s)=>{"use strict";s.d(t,{O:()=>l});var a=s(86725);let r=process.env.NEXT_PUBLIC_SUPABASE_URL,n=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;r&&n||console.warn("Missing Supabase environment variables - using demo mode");let l=(0,a.eI)(r||"https://demo.supabase.co",n||"demo-key")},96885:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},6299:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>r,default:()=>l});let a=(0,s(86843).createProxy)(String.raw`/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/activity-log/page.tsx`),{__esModule:r,$$typeof:n}=a,l=a.default},96339:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>r,default:()=>l});let a=(0,s(86843).createProxy)(String.raw`/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/layout.tsx`),{__esModule:r,$$typeof:n}=a,l=a.default},82917:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>r});var a=s(25036);s(67272);let r={title:"EventGaraget CRM",description:"CRM Portal f\xf6r EventGaraget"};function n({children:e}){return a.jsx("html",{lang:"sv",children:a.jsx("body",{className:"bg-gray-50",children:e})})}},67272:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[638,356,880,934],()=>s(69662));module.exports=a})();