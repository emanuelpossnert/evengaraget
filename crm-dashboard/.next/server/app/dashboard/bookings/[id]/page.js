(()=>{var e={};e.id=73,e.ids=[73],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},98188:e=>{"use strict";e.exports=require("module")},88882:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>g,tree:()=>d});var r=s(50482),a=s(69108),n=s(62563),l=s.n(n),i=s(68300),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["dashboard",{children:["bookings",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,43450)),"/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/bookings/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,96339)),"/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,82917)),"/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/bookings/[id]/page.tsx"],m="/dashboard/bookings/[id]/page",x={require:s,loadChunk:()=>Promise.resolve()},g=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/bookings/[id]/page",pathname:"/dashboard/bookings/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},15264:(e,t,s)=>{Promise.resolve().then(s.bind(s,72353))},92611:(e,t,s)=>{Promise.resolve().then(s.bind(s,77501))},16133:()=>{},37298:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2583,23)),Promise.resolve().then(s.t.bind(s,26840,23)),Promise.resolve().then(s.t.bind(s,38771,23)),Promise.resolve().then(s.t.bind(s,13225,23)),Promise.resolve().then(s.t.bind(s,9295,23)),Promise.resolve().then(s.t.bind(s,43982,23))},72353:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w});var r=s(95344),a=s(3729),n=s(27984),l=s(8428),i=s(64290),o=s(66138),d=s(63024),c=s(73229),m=s(91700),x=s(55794),g=s(16278),u=s(26075),p=s(91917),h=s(48411),b=s(37121),y=s(14513),f=s(39674),v=s(48067),j=s(92760),N=s(38852);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let k=(0,s(69224).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);function _({bookingId:e}){let[t,s]=(0,a.useState)([]),[l,i]=(0,a.useState)(""),[o,d]=(0,a.useState)(!1),[c,m]=(0,a.useState)(0),[x,g]=(0,a.useState)(!1),u=(0,a.useRef)(null);(0,a.useEffect)(()=>{(async()=>{try{let{data:t}=await n.O.from("booking_comments").select("*").eq("booking_id",e).order("created_at",{ascending:!0});if(t){s(t);let e=t.filter(e=>"customer"===e.sender_type).length;m(e)}}catch(e){console.error("Error fetching messages:",e)}})();let t=n.O.channel(`admin-chat:${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"booking_comments",filter:`booking_id=eq.${e}`},e=>{let t=e.new;s(e=>[...e,t]),"customer"===t.sender_type&&m(e=>e+1)}).subscribe();return()=>{t.unsubscribe()}},[e]),(0,a.useEffect)(()=>{u.current?.scrollIntoView({behavior:"smooth"})},[t]);let p=async t=>{if(t.preventDefault(),l.trim())try{d(!0);let{error:t}=await n.O.from("booking_comments").insert([{booking_id:e,sender_type:"admin",sender_name:"EventGaraget Admin",message:l.trim()}]);if(t)throw t;i("")}catch(e){console.error("Error sending message:",e),alert("Kunde inte skicka meddelandet.")}finally{d(!1)}};return x?(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-lg overflow-hidden flex flex-col h-96",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b bg-blue-600 text-white",children:[(0,r.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[r.jsx(N.Z,{size:18}),"Kundenanm\xe4rkningar"]}),r.jsx("button",{onClick:()=>{g(!1),m(0)},className:"hover:bg-blue-700 p-1 rounded transition",children:r.jsx(y.Z,{size:20})})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[0===t.length?r.jsx("div",{className:"flex items-center justify-center h-full text-center",children:(0,r.jsxs)("div",{className:"text-gray-500",children:[r.jsx("p",{className:"font-semibold mb-2",children:"Inga meddelanden \xe4nnu"}),r.jsx("p",{className:"text-sm",children:"Kunden kan st\xe4lla fr\xe5gor h\xe4r"})]})}):t.map(e=>r.jsx("div",{className:`flex ${"admin"===e.sender_type?"justify-end":"justify-start"}`,children:(0,r.jsxs)("div",{className:`max-w-xs px-3 py-2 rounded-lg text-sm ${"admin"===e.sender_type?"bg-blue-600 text-white":"bg-white border border-gray-200 text-gray-900"}`,children:[r.jsx("p",{className:"text-xs font-semibold opacity-75 mb-1",children:"EventGaraget Admin"===e.sender_name?"Ni":e.sender_name}),r.jsx("p",{className:"break-words",children:e.message}),r.jsx("p",{className:"text-xs opacity-70 mt-1",children:new Date(e.created_at).toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"})})]})},e.id)),r.jsx("div",{ref:u})]}),(0,r.jsxs)("form",{onSubmit:p,className:"flex gap-2 p-3 border-t bg-white",children:[r.jsx("input",{type:"text",value:l,onChange:e=>i(e.target.value),placeholder:"Skriv svar...",className:"flex-1 px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-blue-500",disabled:o}),r.jsx("button",{type:"submit",disabled:o||!l.trim(),className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition",children:o?"...":r.jsx(k,{size:16})})]})]}):(0,r.jsxs)("button",{onClick:()=>{g(!0),m(0)},className:"flex items-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold relative",children:[r.jsx(N.Z,{size:18}),"\uD83D\uDCAC Chat",c>0&&r.jsx("span",{className:"ml-auto bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:c})]})}function w(){let e=(0,l.useRouter)(),t=(0,l.useParams)().id,[s,N]=(0,a.useState)(null),[k,w]=(0,a.useState)(null),[S,D]=(0,a.useState)([]),[E,M]=(0,a.useState)([]),[C,z]=(0,a.useState)(""),[Z,P]=(0,a.useState)(!0),[$,A]=(0,a.useState)(!1),[q,F]=(0,a.useState)(null),[T,L]=(0,a.useState)(!0),[O,K]=(0,a.useState)(null),[U,B]=(0,a.useState)(!1),[R,G]=(0,a.useState)([{id:"customer",label:"Kunduppgifter verifierade",completed:!1},{id:"event",label:"Event-detaljer kontrollerade",completed:!1},{id:"delivery",label:"Leverans-adress OK",completed:!1},{id:"products",label:"Produkter \xe4r korrekta",completed:!1},{id:"pricing",label:"Priss\xe4ttning verifierad",completed:!1},{id:"agreement",label:"Avtal granskat",completed:!1}]),[I,W]=(0,a.useState)({});(0,a.useEffect)(()=>{H()},[t]);let H=async()=>{try{P(!0);let{data:e,error:s}=await n.O.from("bookings").select("*").eq("id",t).single();if(s)throw s;if(N(e),W(e),e?.customer_id){let{data:t}=await n.O.from("customers").select("*").eq("id",e.customer_id).single();t&&w(t)}let{data:r}=await n.O.from("booking_wrapping_images").select("*").eq("booking_id",t).order("uploaded_at",{ascending:!1});r&&D(r);let{data:a}=await n.O.from("booking_notes").select("*").eq("booking_id",t).order("created_at",{ascending:!1});a&&M(a)}catch(e){console.error("Error fetching booking data:",e),F({type:"error",text:"Kunde inte ladda bokningsdata"})}finally{P(!1)}},V=e=>{G(t=>t.map(t=>t.id===e?{...t,completed:!t.completed}:t))},X=R.every(e=>e.completed),J=async e=>{try{A(!0);let s={};"delivery"===e?(s.delivery_date=I.delivery_date,s.pickup_date=I.pickup_date,s.delivery_street_address=I.delivery_street_address,s.delivery_postal_code=I.delivery_postal_code,s.delivery_city=I.delivery_city,s.delivery_type=I.delivery_type):"products"===e?s.products_requested=I.products_requested:"pricing"===e&&(s.total_amount=I.total_amount,s.tax_amount=I.tax_amount,s.shipping_cost=I.shipping_cost);let{error:r}=await n.O.from("bookings").update(s).eq("id",t);if(r)throw r;N(e=>e?{...e,...I}:null),K(null),F({type:"success",text:`${e} uppdaterad!`}),setTimeout(()=>F(null),3e3)}catch(e){console.error("Error updating booking:",e),F({type:"error",text:"Kunde inte uppdatera"}),setTimeout(()=>F(null),3e3)}finally{A(!1)}},Q=async()=>{if(!X){F({type:"error",text:"Checka av alla kontroller innan du godk\xe4nner!"}),setTimeout(()=>F(null),3e3);return}try{A(!0),console.log("\uD83D\uDD04 Starting booking approval for:",t);let s=Math.random().toString(36).substring(2,15)+Date.now().toString(36);console.log("✅ Generated token:",s),console.log("\uD83D\uDCDD Inserting booking token...");let{error:r}=await n.O.from("booking_tokens").insert([{booking_id:t,token:s}]);if(r)throw console.error("❌ Token error:",r),Error(`Token error: ${r.message}`);console.log("✅ Token created successfully"),console.log("\uD83D\uDD04 Updating booking status to pending...");let{error:a}=await n.O.from("bookings").update({status:"pending"}).eq("id",t);if(a)throw console.error("❌ Booking update error:",a),Error(`Booking update error: ${a.message}`);console.log("✅ Booking status updated to pending"),console.log("\uD83D\uDCCB Checking for existing booking confirmation...");let{data:l}=await n.O.from("booking_confirmations").select("id").eq("booking_id",t).single();if(l){console.log("✅ Booking confirmation already exists - updating email_sent flag...");let{error:e}=await n.O.from("booking_confirmations").update({email_sent:!1}).eq("booking_id",t);e?console.error("⚠️ Update confirmation error:",e):console.log("✅ Booking confirmation updated")}else{console.log("\uD83D\uDCCB Creating booking confirmation...");let{error:e}=await n.O.from("booking_confirmations").insert([{booking_id:t,email_sent:!1}]);e?console.error("⚠️ Confirmation error (non-critical):",e):console.log("✅ Booking confirmation created")}N(e=>e?{...e,status:"pending"}:null),F({type:"success",text:"✅ Bokning godk\xe4nd f\xf6r granskning! Status: V\xe4ntande p\xe5 godk\xe4nnande..."}),setTimeout(()=>{e.push("/dashboard/bookings")},2e3)}catch(t){console.error("❌ Error approving booking:",t);let e=t instanceof Error?t.message:"Ok\xe4nt fel";F({type:"error",text:`Kunde inte godk\xe4nna bokning: ${e}`}),setTimeout(()=>F(null),5e3)}finally{A(!1)}},Y=async()=>{if(s)try{let e=new j.ZP;e.internal.pageSize.getHeight();let t=e.internal.pageSize.getWidth(),r=20;e.setFontSize(20),e.text("SIGNERAT AVTAL",t/2,r,{align:"center"}),r+=15,e.setFontSize(12),e.text(`Bokningsnummer: ${s.booking_number}`,20,r),r+=8,e.text(`Datum signerat: ${s.contract_signed_at?(0,f.WU)(new Date(s.contract_signed_at),"d MMMM yyyy HH:mm",{locale:v.sv}):"N/A"}`,20,r),r+=12,e.setFontSize(14),e.text("Kunduppgifter",20,r),r+=8,e.setFontSize(11),e.text(`Namn: ${k?.name||"N/A"}`,20,r),r+=6,e.text(`Email: ${k?.email||"N/A"}`,20,r),r+=6,e.text(`Telefon: ${k?.phone||"N/A"}`,20,r),r+=6,e.text(`F\xf6retag: ${k?.company_name||"N/A"}`,20,r),r+=12,e.setFontSize(14),e.text("Event-information",20,r),r+=8,e.setFontSize(11),e.text(`Event Datum: ${(0,f.WU)(new Date(s.event_date),"d MMMM yyyy",{locale:v.sv})}`,20,r),r+=6,e.text(`Plats: ${s.location}`,20,r),r+=12,e.setFontSize(14),e.text("Leveransinformation",20,r),r+=8,e.setFontSize(11),e.text(`Datum: ${(0,f.WU)(new Date(s.delivery_date),"d MMMM yyyy",{locale:v.sv})}`,20,r),r+=6,e.text(`Adress: ${s.delivery_street_address}`,20,r),r+=6,e.text(`${s.delivery_postal_code} ${s.delivery_city}`,20,r),r+=12,e.setFontSize(14),e.text("Belopp",20,r),r+=8,e.setFontSize(11),e.text(`Summa: ${s.total_amount?.toLocaleString("sv-SE")} SEK`,20,r),r+=6,s.tax_amount&&(e.text(`Moms: ${s.tax_amount?.toLocaleString("sv-SE")} SEK`,20,r),r+=6),s.shipping_cost&&(e.text(`Frakt: ${s.shipping_cost?.toLocaleString("sv-SE")} SEK`,20,r),r+=6),e.save(`${s.booking_number}_avtal.pdf`),F({type:"success",text:"PDF h\xe4mtad!"}),setTimeout(()=>F(null),2e3)}catch(e){console.error("Error generating PDF:",e),F({type:"error",text:"Kunde inte generera PDF"}),setTimeout(()=>F(null),2e3)}},ee=async()=>{if(s)try{let e=new j.ZP,t=e.internal.pageSize.getHeight(),r=e.internal.pageSize.getWidth(),a=20;e.setFontSize(24),e.text("BOKNINGS\xd6VERSIKT",r/2,a,{align:"center"}),a+=15,e.setFontSize(12),e.text(`Bokningsnummer: ${s.booking_number}`,20,a),a+=7,e.text(`Status: ${"draft"===s.status?"Utkast":"pending"===s.status?"V\xe4ntande":"confirmed"===s.status?"Bekr\xe4ftad":s.status}`,20,a),a+=12,e.setFontSize(14),e.text("KUND",20,a),a+=8,e.setFontSize(11),e.text(`Namn: ${k?.name}`,20,a),a+=6,e.text(`Email: ${k?.email}`,20,a),a+=6,e.text(`Telefon: ${k?.phone}`,20,a),a+=6,e.text(`F\xf6retag: ${k?.company_name||"-"}`,20,a),a+=12,e.setFontSize(14),e.text("EVENT",20,a),a+=8,e.setFontSize(11),e.text(`Start: ${(0,f.WU)(new Date(s.event_date),"d MMMM yyyy",{locale:v.sv})}`,20,a),a+=6,s.event_end_date&&s.event_end_date!==s.event_date&&(e.text(`Slut: ${(0,f.WU)(new Date(s.event_end_date),"d MMMM yyyy",{locale:v.sv})}`,20,a),a+=6),e.text(`Plats: ${s.location}`,20,a),a+=12,e.setFontSize(14),e.text("LEVERANS",20,a),a+=8,e.setFontSize(11),e.text(`Datum: ${(0,f.WU)(new Date(s.delivery_date),"d MMMM yyyy",{locale:v.sv})}`,20,a),a+=6,e.text(`Adress: ${s.delivery_street_address}`,20,a),a+=6,e.text(`${s.delivery_postal_code} ${s.delivery_city}`,20,a),a+=12;let n=[];try{if(s.products_requested){let e=s.products_requested;"string"==typeof e&&(e.startsWith('"')&&(e=JSON.parse(e)),e=JSON.parse(e)),n=Array.isArray(e)?e:[]}}catch(e){console.error("Error parsing products:",e)}e.setFontSize(14),e.text("PRODUKTER",20,a),a+=8,e.setFontSize(11),n.length>0?n.forEach(s=>{a>t-20&&(e.addPage(),a=20),e.text(`• ${s.name} (${s.quantity||1} st)`,25,a),a+=6}):(e.text("Ingen produkter listade",25,a),a+=6),a+=6,e.setFontSize(14),e.text("BELOPP",20,a),a+=8,e.setFontSize(11),e.text(`Summa: ${s.total_amount?.toLocaleString("sv-SE")} SEK`,20,a),a+=6,s.tax_amount&&s.tax_amount>0&&(e.text(`Moms: ${s.tax_amount?.toLocaleString("sv-SE")} SEK`,20,a),a+=6),s.shipping_cost&&s.shipping_cost>0&&(e.text(`Frakt: ${s.shipping_cost?.toLocaleString("sv-SE")} SEK`,20,a),a+=6),e.setFontSize(12),e.setFont(void 0,"bold");let l=(s.total_amount||0)+(s.tax_amount||0)+(s.shipping_cost||0);e.text(`TOTALT: ${l.toLocaleString("sv-SE")} SEK`,20,a),e.save(`${s.booking_number}_bokning.pdf`),F({type:"success",text:"Boknings-PDF h\xe4mtad!"}),setTimeout(()=>F(null),2e3)}catch(e){console.error("Error generating booking PDF:",e),F({type:"error",text:"Kunde inte generera boknings-PDF"}),setTimeout(()=>F(null),2e3)}};if(Z)return r.jsx("div",{className:"text-center py-12 text-gray-500",children:"Laddar..."});if(!s)return r.jsx("div",{className:"text-center py-12",children:r.jsx("p",{className:"text-red-600 font-semibold",children:"Bokning inte hittad"})});let et=[];try{if(s.products_requested){let e=s.products_requested;"string"==typeof e&&(e.startsWith('"')&&(e=JSON.parse(e)),e=JSON.parse(e)),et=Array.isArray(e)?e:[]}}catch(e){console.error("Error parsing products:",e)}let es=async()=>{if(!C.trim()){F({type:"error",text:"Anteckningen kan inte vara tom"});return}try{A(!0);let{data:{user:e}}=await n.O.auth.getUser(),{error:s}=await n.O.from("booking_notes").insert([{booking_id:t,note:C,created_by_email:e?.email||"unknown",created_by_name:e?.user_metadata?.full_name||e?.email||"Unknown"}]);if(s)throw s;F({type:"success",text:"Anteckning tillagd!"}),z(""),H(),setTimeout(()=>F(null),2e3)}catch(e){console.error("Error adding note:",e),F({type:"error",text:"Kunde inte l\xe4gga till anteckning"})}finally{A(!1)}},er=async e=>{if(window.confirm("Ta bort denna anteckning?"))try{A(!0);let{error:t}=await n.O.from("booking_notes").delete().eq("id",e);if(t)throw t;F({type:"success",text:"Anteckning borttagen"}),H(),setTimeout(()=>F(null),2e3)}catch(e){console.error("Error deleting note:",e),F({type:"error",text:"Kunde inte ta bort anteckning"})}finally{A(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[q&&(0,r.jsxs)("div",{className:`p-4 rounded-lg font-semibold flex items-center gap-2 ${"success"===q.type?"bg-green-100 text-green-700 border border-green-300":"bg-red-100 text-red-700 border border-red-300"}`,children:["success"===q.type?r.jsx(i.Z,{size:20}):r.jsx(o.Z,{size:20}),q.text]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("button",{onClick:()=>e.push("/dashboard/bookings"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(d.Z,{size:24,className:"text-gray-600"})}),r.jsx("h1",{className:"text-3xl font-bold text-gray-900 text-center flex-1",children:s.booking_number}),r.jsx("div",{className:"w-24"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 h-fit",children:[(0,r.jsxs)("h2",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[r.jsx(i.Z,{size:20,className:"text-orange-600"}),"Granskning"]}),r.jsx("div",{className:"space-y-3",children:R.map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer p-2 hover:bg-gray-50 rounded",children:[r.jsx("input",{type:"checkbox",checked:e.completed,onChange:()=>V(e.id),className:"w-5 h-5 rounded border-gray-300"}),r.jsx("span",{className:`text-sm ${e.completed?"text-gray-600 line-through":"text-gray-700 font-medium"}`,children:e.label})]},e.id))}),(0,r.jsxs)("button",{onClick:Q,disabled:!X||$,className:`w-full mt-6 py-3 rounded-lg font-semibold flex items-center justify-center gap-2 transition-all ${X?"bg-green-100 text-green-600 hover:bg-green-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[r.jsx(i.Z,{size:18}),"Godk\xe4nn Bokning"]}),s?.status==="draft"&&(0,r.jsxs)("button",{onClick:async()=>{try{A(!0);let{error:s}=await n.O.from("bookings").update({status:"cancelled"}).eq("id",t);if(s)throw s;F({type:"success",text:"Bokning avb\xf6jd"}),setTimeout(()=>{e.push("/dashboard/bookings")},2e3)}catch(e){console.error("Error rejecting booking:",e),F({type:"error",text:"Kunde inte avb\xf6ja bokning"}),setTimeout(()=>F(null),3e3)}finally{A(!1)}},disabled:$,className:"w-full py-3 rounded-lg font-semibold flex items-center justify-center gap-2 transition-all bg-red-100 text-red-600 hover:bg-red-200 disabled:opacity-50",children:[r.jsx(c.Z,{size:18}),"Avb\xf6j Bokning"]}),!X&&r.jsx("p",{className:"text-xs text-gray-500 text-center mt-2",children:"Checka av alla innan godk\xe4nnande"})]}),(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:(0,r.jsxs)("h3",{className:"font-bold text-gray-900 flex items-center gap-2",children:[r.jsx(m.Z,{size:18})," Kund"]})}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[r.jsx("p",{className:"font-semibold text-gray-900",children:k?.name}),r.jsx("p",{className:"text-gray-600",children:k?.company_name}),r.jsx("p",{className:"text-blue-600",children:k?.email}),r.jsx("p",{className:"text-blue-600",children:k?.phone})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,r.jsxs)("h3",{className:"font-bold text-gray-900 mb-3 flex items-center gap-2",children:[r.jsx(x.Z,{size:18})," Event"]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("p",{children:[r.jsx("span",{className:"text-gray-600",children:"Start:"})," ",(0,f.WU)(new Date(s.event_date),"d MMM yyyy",{locale:v.sv})]}),s.event_end_date&&(0,r.jsxs)("p",{children:[r.jsx("span",{className:"text-gray-600",children:"Slut:"})," ",(0,f.WU)(new Date(s.event_end_date),"d MMM yyyy",{locale:v.sv})]}),(0,r.jsxs)("p",{children:[r.jsx("span",{className:"text-gray-600",children:"Plats:"}),(0,r.jsxs)("a",{href:`https://www.google.com/maps/search/${encodeURIComponent(s.location)}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline ml-1",title:"\xd6ppna i Google Maps",children:[s.location," \uD83D\uDDFA️"]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("h3",{className:"font-bold text-gray-900 flex items-center gap-2",children:[r.jsx(g.Z,{size:18})," Leverans"]}),"delivery"!==O&&(0,r.jsxs)("button",{onClick:()=>{K("delivery"),W(s)},className:"text-blue-600 hover:text-blue-700 text-sm font-semibold flex items-center gap-1",children:[r.jsx(u.Z,{size:14})," Redigera"]})]}),"delivery"===O?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Leveransdatum \uD83D\uDCE6 (Gr\xf6n i kalender)"}),r.jsx("input",{type:"date",value:I.delivery_date?.split("T")[0]||"",onChange:e=>W({...I,delivery_date:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Returdatum \uD83D\uDD04 (Orange i kalender)"}),r.jsx("input",{type:"date",value:I.pickup_date?.split("T")[0]||"",onChange:e=>W({...I,pickup_date:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Adress"}),r.jsx("input",{type:"text",value:I.delivery_street_address||"",onChange:e=>W({...I,delivery_street_address:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Postnummer"}),r.jsx("input",{type:"text",value:I.delivery_postal_code||"",onChange:e=>W({...I,delivery_postal_code:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Stad"}),r.jsx("input",{type:"text",value:I.delivery_city||"",onChange:e=>W({...I,delivery_city:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Leveranstyp"}),(0,r.jsxs)("select",{value:I.delivery_type||"internal",onChange:e=>W({...I,delivery_type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm",children:[r.jsx("option",{value:"internal",children:"✅ INTERN - EventGaraget levererar (Stockholm)"}),r.jsx("option",{value:"external",children:"\uD83D\uDCE6 EXTERN - Fraktpartner levererar"})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"internal"===I.delivery_type?"EventGaraget hanterar leveransen inom Stockholm-omr\xe5det.":"En extern fraktpartner kommer att hantera leveransen."})]}),(0,r.jsxs)("div",{className:"flex gap-2 pt-2",children:[r.jsx("button",{onClick:()=>J("delivery"),disabled:$,className:"flex-1 px-3 py-2 bg-green-100 text-green-600 rounded text-sm font-semibold hover:bg-green-200",children:"Spara"}),r.jsx("button",{onClick:()=>K(null),className:"flex-1 px-3 py-2 bg-gray-100 text-gray-600 rounded text-sm font-semibold",children:"Avbryt"})]})]}):(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("p",{children:[r.jsx("span",{className:"text-gray-600",children:"Leveransdatum \uD83D\uDCE6:"})," ",(0,f.WU)(new Date(s.delivery_date),"d MMM yyyy",{locale:v.sv})]}),s.pickup_date&&(0,r.jsxs)("p",{children:[r.jsx("span",{className:"text-gray-600",children:"Returdatum \uD83D\uDD04:"})," ",(0,f.WU)(new Date(s.pickup_date),"d MMM yyyy",{locale:v.sv})]}),(0,r.jsxs)("p",{children:[r.jsx("span",{className:"text-gray-600",children:"Adress:"}),(0,r.jsxs)("a",{href:`https://www.google.com/maps/search/${encodeURIComponent(`${s.delivery_street_address}, ${s.delivery_postal_code} ${s.delivery_city}`)}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline ml-1",title:"\xd6ppna i Google Maps",children:[s.delivery_street_address," \uD83D\uDDFA️"]})]}),(0,r.jsxs)("p",{children:[r.jsx("span",{className:"text-gray-600",children:"Postadress:"})," ",s.delivery_postal_code," ",s.delivery_city]}),(0,r.jsxs)("div",{className:"mt-3 p-2 rounded bg-gray-50 border border-gray-200",children:[r.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-1",children:"\uD83D\uDCE6 Leveranstyp:"}),"internal"===s.delivery_type?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"inline-block px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-semibold",children:"✅ INTERN"}),r.jsx("span",{className:"text-gray-600 text-xs",children:"EventGaraget levererar (Stockholm)"})]}):(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"inline-block px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-semibold",children:"\uD83D\uDCE6 EXTERN"}),r.jsx("span",{className:"text-gray-600 text-xs",children:"Fraktpartner levererar"})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[r.jsx("div",{className:"flex items-center justify-between mb-3",children:(0,r.jsxs)("h3",{className:"font-bold text-gray-900 flex items-center gap-2",children:[r.jsx(p.Z,{size:18})," Produkter (",et.length,")"]})}),"products"===O?(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Produktlistan \xe4r l\xe5st efter granskning. Kontakta admin f\xf6r \xe4ndringar."}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-2 font-semibold",children:"Befintliga produkter:"}),r.jsx("div",{className:"space-y-2 mb-4",children:et.map((e,t)=>r.jsx("div",{className:"p-3 bg-gray-50 rounded border border-gray-200",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-gray-900 font-medium",children:e.name}),(0,r.jsxs)("span",{className:"text-gray-600 text-sm",children:[e.quantity," st"]})]})},t))})]}),r.jsx("div",{className:"flex gap-2",children:r.jsx("button",{onClick:()=>K(null),className:"flex-1 px-3 py-2 bg-gray-100 text-gray-600 rounded text-sm font-semibold",children:"St\xe4ng"})})]}):r.jsx("div",{className:"space-y-2",children:et.map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between text-sm py-2 border-b border-gray-100 last:border-0",children:[r.jsx("span",{className:"text-gray-700",children:e.name}),(0,r.jsxs)("span",{className:"font-semibold text-gray-900",children:[e.quantity," st"]})]},t))})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg border border-green-200 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("h3",{className:"font-bold text-gray-900 flex items-center gap-2",children:[r.jsx(h.Z,{size:18})," Priss\xe4ttning"]}),"pricing"!==O&&(0,r.jsxs)("button",{onClick:()=>{K("pricing"),W(s)},className:"text-blue-600 hover:text-blue-700 text-sm font-semibold flex items-center gap-1",children:[r.jsx(u.Z,{size:14})," Redigera"]})]}),"pricing"===O?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Summa (ex moms)"}),r.jsx("input",{type:"number",step:"0.01",value:I.total_amount||"",onChange:e=>W({...I,total_amount:parseFloat(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Moms"}),r.jsx("input",{type:"number",step:"0.01",value:I.tax_amount||"",onChange:e=>W({...I,tax_amount:parseFloat(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Frakt"}),r.jsx("input",{type:"number",step:"0.01",value:I.shipping_cost||"",onChange:e=>W({...I,shipping_cost:parseFloat(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 pt-2",children:[r.jsx("button",{onClick:()=>J("pricing"),disabled:$,className:"flex-1 px-3 py-2 bg-green-100 text-green-600 rounded text-sm font-semibold",children:"Spara"}),r.jsx("button",{onClick:()=>K(null),className:"flex-1 px-3 py-2 bg-gray-100 text-gray-600 rounded text-sm font-semibold",children:"Avbryt"})]})]}):(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Summa:"}),(0,r.jsxs)("span",{className:"font-semibold",children:[s.total_amount?.toLocaleString("sv-SE")," SEK"]})]}),void 0!==s.tax_amount&&s.tax_amount>0&&(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Moms:"}),(0,r.jsxs)("span",{className:"font-semibold",children:[s.tax_amount?.toLocaleString("sv-SE")," SEK"]})]}),void 0!==s.shipping_cost&&s.shipping_cost>0&&(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Frakt:"}),(0,r.jsxs)("span",{className:"font-semibold",children:[s.shipping_cost?.toLocaleString("sv-SE")," SEK"]})]}),(0,r.jsxs)("div",{className:"pt-2 border-t border-green-200 flex justify-between",children:[r.jsx("span",{className:"text-gray-700 font-bold",children:"Totalt:"}),(0,r.jsxs)("span",{className:"text-xl font-bold text-green-700",children:[((s.total_amount||0)+(s.tax_amount||0)+(s.shipping_cost||0)).toLocaleString("sv-SE")," SEK"]})]})]})]}),(0,r.jsxs)("button",{onClick:ee,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-purple-100 text-purple-600 rounded-lg hover:bg-purple-200 transition-colors font-semibold",children:[r.jsx(b.Z,{size:18}),"Exportera Bokning (PDF)"]}),S.length>0&&(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,r.jsxs)("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:["\uD83C\uDFA8 Foliering Bilder (",S.length,")"]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:S.map(e=>(0,r.jsxs)("a",{href:e.image_url,target:"_blank",rel:"noopener noreferrer",className:"group relative overflow-hidden rounded-lg border border-gray-200 hover:border-blue-500 transition",children:[r.jsx("img",{src:e.image_url,alt:e.file_name,className:"w-full h-32 object-cover group-hover:scale-110 transition",onError:e=>{e.currentTarget.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="%23999"%3E%3Cpath stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4v.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /%3E%3C/svg%3E'}}),r.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition flex items-center justify-center",children:r.jsx("span",{className:"text-white opacity-0 group-hover:opacity-100 transition text-sm font-semibold",children:"\xd6ppna"})}),(0,r.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-75 text-white p-2",children:[r.jsx("p",{className:"text-xs truncate font-semibold",children:e.file_name}),r.jsx("p",{className:"text-xs opacity-75",children:new Date(e.uploaded_at).toLocaleDateString("sv-SE")})]})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r.jsx("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:"\uD83D\uDCDD Anteckningar"}),(0,r.jsxs)("div",{className:"mb-4 space-y-3",children:[r.jsx("textarea",{value:C,onChange:e=>z(e.target.value),placeholder:"L\xe4gg till en anteckning...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 resize-none",rows:3}),r.jsx("button",{onClick:es,disabled:$||!C.trim(),className:"w-full px-4 py-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 disabled:bg-gray-100 disabled:text-gray-400 font-semibold transition-colors",children:$?"L\xe4gger till...":"L\xe4gg till anteckning"})]}),r.jsx("div",{className:"space-y-3",children:0===E.length?r.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Inga anteckningar \xe4n"}):E.map(e=>(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs font-semibold text-gray-600",children:e.created_by_name}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[new Date(e.created_at).toLocaleDateString("sv-SE")," kl ",new Date(e.created_at).toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"})]})]}),r.jsx("button",{onClick:()=>er(e.id),disabled:$,className:"text-red-500 hover:text-red-700 text-xs font-semibold disabled:text-gray-400",children:"✕"})]}),r.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:e.note})]},e.id))})]}),r.jsx("div",{className:"mt-6",children:r.jsx(_,{bookingId:t})}),s.contract_signed&&(0,r.jsxs)("button",{onClick:()=>B(!0),className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors font-semibold",children:[r.jsx(b.Z,{size:18}),"Se Signerat Avtal"]})]})]}),U&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex items-center justify-between",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Signerat Avtal"}),r.jsx("button",{onClick:()=>B(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(y.Z,{size:24,className:"text-gray-600"})})]}),(0,r.jsxs)("div",{className:"p-6 space-y-4",children:[r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,r.jsxs)("p",{className:"text-sm text-green-700 font-semibold",children:["✅ Signerat ",s.contract_signed_at&&(0,f.WU)(new Date(s.contract_signed_at),"d MMM yyyy HH:mm",{locale:v.sv})]})}),(0,r.jsxs)("div",{className:"border border-gray-300 rounded-lg p-6 bg-gray-50 text-center",children:[r.jsx(b.Z,{size:48,className:"mx-auto text-gray-400 mb-4"}),r.jsx("p",{className:"text-gray-600 font-semibold mb-2",children:"Signerat Avtal"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Bokning: ",s.booking_number]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("button",{onClick:Y,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors font-semibold",children:[r.jsx(b.Z,{size:18}),"Ladda ner PDF"]}),r.jsx("button",{onClick:()=>B(!1),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-600 rounded-lg font-semibold hover:bg-gray-200",children:"St\xe4ng"})]})]})]})})]})}},77501:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>S});var r=s(95344),a=s(3729),n=s(8428),l=s(27984),i=s(56506),o=s(2273),d=s(89895),c=s(12401),m=s(2246),x=s(55794),g=s(16278),u=s(69599),p=s(91917),h=s(75950),b=s(37121),y=s(50340),f=s(28240),v=s(13746),j=s(48120);function N({user:e,onLogout:t}){let s=(0,n.usePathname)(),[N,k]=(0,a.useState)({});(0,a.useEffect)(()=>{_()},[]);let _=async()=>{try{let e={},{data:t}=await l.O.from("booking_tasks").select("id").eq("status","pending");e.todo=t?.length||0;let{data:s}=await l.O.from("bookings").select("id").eq("status","pending");e.bookings=s?.length||0;let{data:r}=await l.O.from("printer_foiling_orders").select("id");e.printer=r?.length||0;let{data:a}=await l.O.from("booking_tasks").select("id").neq("status","completed");e.warehouse=a?.length||0,k(e)}catch(e){console.error("Error fetching badge counts:",e)}},w=[{name:"Dashboard",icon:o.Z,href:"/dashboard",roles:["admin","manager"]},{name:"Kunder",icon:d.Z,href:"/dashboard/customers",roles:["admin","manager","support"]},{name:"Bokningar",icon:c.Z,href:"/dashboard/bookings",roles:["admin","manager"]},{name:"Att G\xf6ra",icon:m.Z,href:"/dashboard/todo",roles:["admin","manager"]},{name:"Kalender",icon:x.Z,href:"/dashboard/calendar",roles:["admin","manager","warehouse"]},{name:"Lager",icon:g.Z,href:"/dashboard/warehouse",roles:["warehouse"]},{name:"Lager Admin",icon:g.Z,href:"/dashboard/warehouse-admin",roles:["admin"]},{name:"Tryckeri",icon:u.Z,href:"/dashboard/printer",roles:["admin","printer"]},{name:"Produkter & Prislista",icon:p.Z,href:"/dashboard/products",roles:["admin","manager"]},{name:"FAQ",icon:h.Z,href:"/dashboard/faq",roles:["admin","manager"]},{name:"Till\xe4gg",icon:p.Z,href:"/dashboard/addons",roles:["admin","manager"]},{name:"Aktivitetslogg",icon:b.Z,href:"/dashboard/activity-log",roles:["admin"]},{name:"Analytics",icon:y.Z,href:"/dashboard/analytics",roles:["admin"]},{name:"Anv\xe4ndare",icon:f.Z,href:"/dashboard/users",roles:["admin"]},{name:"Inst\xe4llningar",icon:v.Z,href:"/dashboard/settings",roles:["admin"]}].filter(t=>t.roles.includes(e.role));return(0,r.jsxs)("aside",{className:"fixed left-0 top-0 h-screen w-64 bg-white border-r border-gray-200 flex flex-col",children:[r.jsx("div",{className:"p-6 border-b border-gray-200",children:r.jsx("div",{className:"flex items-center gap-3",children:r.jsx("img",{src:"/logo.png",alt:"EventGaraget",className:"h-18"})})}),r.jsx("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:w.map(e=>{let t=e.icon,a="/dashboard"===e.href?s===e.href:s.startsWith(e.href),n=0;return"/dashboard/todo"===e.href&&(n=N.todo||0),"/dashboard/bookings"===e.href&&(n=N.bookings||0),"/dashboard/printer"===e.href&&(n=N.printer||0),"/dashboard/warehouse"===e.href&&(n=N.warehouse||0),(0,r.jsxs)(i.default,{href:e.href,className:`flex items-center gap-3 px-4 py-2 rounded-lg transition-colors justify-between ${a?"bg-red-50 text-red-600 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx(t,{size:20}),r.jsx("span",{children:e.name})]}),n>0&&r.jsx("span",{className:"bg-red-600 text-white text-xs font-bold px-2 py-1 rounded-full min-w-max",children:n})]},e.href)})}),(0,r.jsxs)("div",{className:"p-4 border-t border-gray-200 space-y-3",children:[(0,r.jsxs)("div",{className:"px-4 py-3 bg-gray-50 rounded-lg",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.full_name}),r.jsx("p",{className:"text-xs text-gray-500",children:e.email}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 capitalize mt-1",children:["Rolle: ",e.role]})]}),(0,r.jsxs)("button",{onClick:t,className:"w-full flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[r.jsx(j.Z,{size:18}),r.jsx("span",{className:"text-sm",children:"Logga ut"})]})]})]})}var k=s(28765),_=s(33037);function w({user:e}){return(0,r.jsxs)("div",{className:"fixed top-0 left-64 right-0 h-16 bg-white border-b border-gray-200 flex items-center justify-between px-8 z-40",children:[r.jsx("div",{className:"flex-1 max-w-md",children:(0,r.jsxs)("div",{className:"relative",children:[r.jsx(k.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),r.jsx("input",{type:"text",placeholder:"S\xf6k kunder, bokningar...",className:"w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-red-500 focus:bg-white"})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-6 ml-8",children:[(0,r.jsxs)("button",{className:"relative p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:[r.jsx(_.Z,{size:20}),r.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 pl-6 border-l border-gray-200",children:[r.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-sm font-bold text-red-600",children:e.full_name.split(" ").map(e=>e[0]).join("").toUpperCase()})}),r.jsx("span",{className:"text-sm text-gray-700",children:e.full_name})]})]})]})}function S({children:e}){let t=(0,n.useRouter)(),[s,i]=(0,a.useState)(null),[o,d]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{try{let{data:{session:e}}=await l.O.auth.getSession();if(!e){t.push("/");return}let{data:s}=await l.O.from("user_profiles").select("*").eq("id",e.user.id).single();s&&i(s)}catch(e){console.error("Auth check error:",e),t.push("/")}finally{d(!1)}})()},[t]);let c=async()=>{await l.O.auth.signOut(),t.push("/")};return o?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-lg gradient-primary animate-pulse mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Laddar..."})]})}):s?(0,r.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[r.jsx(N,{user:s,onLogout:c}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col ml-64",children:[r.jsx(w,{user:s}),r.jsx("main",{className:"flex-1 overflow-auto pt-20 px-8 pb-8",children:e})]})]}):null}},27984:(e,t,s)=>{"use strict";s.d(t,{O:()=>l});var r=s(86725);let a=process.env.NEXT_PUBLIC_SUPABASE_URL,n=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;a&&n||console.warn("Missing Supabase environment variables - using demo mode");let l=(0,r.eI)(a||"https://demo.supabase.co",n||"demo-key")},66138:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(69224).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},91700:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(69224).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},64290:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(69224).Z)("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},48411:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(69224).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},38852:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(69224).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},26075:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(69224).Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]])},73229:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(69224).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},14513:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(69224).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},43450:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>l});let r=(0,s(86843).createProxy)(String.raw`/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/bookings/[id]/page.tsx`),{__esModule:a,$$typeof:n}=r,l=r.default},96339:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>l});let r=(0,s(86843).createProxy)(String.raw`/Users/emanuelpossnert/Documents/Dev projects/Eventgaraget/crm-dashboard/app/dashboard/layout.tsx`),{__esModule:a,$$typeof:n}=r,l=r.default},82917:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>a});var r=s(25036);s(67272);let a={title:"EventGaraget CRM",description:"CRM Portal f\xf6r EventGaraget"};function n({children:e}){return r.jsx("html",{lang:"sv",children:r.jsx("body",{className:"bg-gray-50",children:e})})}},67272:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[638,356,880,934,184,377],()=>s(88882));module.exports=r})();